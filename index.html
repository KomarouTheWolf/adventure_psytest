<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èº«å¿ƒç‹€æ…‹å…¬æœƒè©•ä¼°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* å¼•å…¥ç°½åèˆ‡å°ç« ç”¨å­—é«”ï¼šè‹±æ¤æ¥·æ›¸ */
        @font-face {
            font-family: 'Ackaisyo';
            src: url('è‹±æ¤æ¥·æ›¸ackaisyo.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* å¼•å…¥æ¨™é¡Œç”¨å­—é«”ï¼šJasonHandwriting */
        @font-face {
            font-family: 'JasonHandwriting';
            src: url('JasonHandwriting5.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* ä¸­ä¸–ç´€å¥‡å¹»é¢¨æ ¼å®šç¾© */
        :root {
            --parchment: #f3e5ab;
            --parchment-light: #fdf6e3;
            --ink: #2c1810;
            --wood: #5d4037;
            --gold: #d4af37;
            --blood: #8a1c1c;
            --magic: #1a237e;
        }

        body {
            /* é è¨­å…§æ–‡ç¶­æŒæ˜“è®€çš„è¥¯ç·šé«” */
            font-family: 'Crimson Text', 'Noto Serif TC', serif;
            background-color: #e6d2b5;
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 20.5V18H0v-2h20v-2H0v-2h20v-2H0V8h20V6H0V4h20V2H0V0h22v20h2V0h2v20h2V0h2v20h2V0h2v20h2v2H22v18h-2v-2H0v-2h20v-2H0v-2h20v-2H0v-2h20v-2H0v-2h20v-2H0v-2h20z' fill='%23dcc6a0' fill-opacity='0.4' fill-rule='evenodd'/%3E%3C/svg%3E");
            color: var(--ink);
            overflow-x: hidden; /* é˜²æ­¢å‹•ç•«å°è‡´æ²è»¸å‡ºç¾ */
        }

        /* æ¨™é¡Œé¡ä½¿ç”¨ JasonHandwriting */
        h1, h2, h3, .custom-font {
            font-family: 'JasonHandwriting', 'Noto Serif TC', serif;
        }

        /* ç°½åå°ˆç”¨å­—é«” */
        .signature-font {
            font-family: 'Ackaisyo', serif;
        }

        /* æœ¨é ­ç´‹ç†èƒŒæ™¯æ¨£å¼ - æ©«å‘ç´‹è·¯ */
        .wood-grain {
            background-color: #5d4037;
            /* æ”¹ç‚º 0deg (æˆ– 180deg) è®“æ¢ç´‹å‘ˆç¾æ©«å‘ */
            background-image: repeating-linear-gradient(
                0deg,
                rgba(62, 39, 35, 1) 0px,
                rgba(62, 39, 35, 1) 10px,
                rgba(93, 64, 55, 1) 12px,
                rgba(93, 64, 55, 1) 20px,
                rgba(78, 52, 46, 1) 22px,
                rgba(78, 52, 46, 1) 35px
            );
            /* æ·±é‚ƒçš„å…§é™°å½±å¢åŠ åšåº¦æ„Ÿ */
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
            position: relative;
            border-bottom: 4px solid #281912;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8); /* æ–‡å­—é™°å½±ï¼Œå¢åŠ å°æ¯” */
        }

        /* æ·»åŠ å™ªé»æ¿¾é¡å±¤ï¼Œè®“æœ¨é ­çœ‹èµ·ä¾†æ›´çœŸå¯¦ç²—ç³™ */
        .wood-grain::before {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.15'/%3E%3C/svg%3E");
            opacity: 0.6;
            pointer-events: none;
            mix-blend-mode: overlay;
        }

        /* å·è»¸/å¡ç‰‡å®¹å™¨ */
        .scroll-container {
            background-color: var(--parchment-light);
            border: 4px double var(--wood);
            box-shadow: 0 10px 20px rgba(44, 24, 16, 0.3), inset 0 0 40px rgba(139, 69, 19, 0.1);
            position: relative;
        }

        .scroll-container::before {
            content: '';
            position: absolute;
            top: 4px; left: 4px; right: 4px; bottom: 4px;
            border: 1px solid var(--gold);
            pointer-events: none;
            border-radius: 20px;
        }

        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            padding: 8px;
            background-color: #d7ccc8;
            border-radius: 8px;
            border: 2px solid var(--wood);
        }

        .bingo-cell {
            aspect-ratio: 1 / 1;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 4px;
            font-size: 0.9rem;
            line-height: 1.2;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #efebe9;
            border: 1px solid #a1887f;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }
        
        .bingo-cell:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-color: var(--wood);
            z-index: 10;
        }

        /* é¢¨éšªé …ç›®çš„æ¨£å¼ - ç´…è‰²é­”æ³•å°è¨˜ */
        .bingo-cell.active {
            background-color: #ffcdd2;
            border-color: var(--blood);
            color: #580808;
            box-shadow: inset 0 0 15px rgba(183, 28, 28, 0.3);
        }
        
        /* å‘¼å¸ç‡ˆç‰¹æ•ˆ */
        @keyframes breathe-glow {
            0%, 100% { box-shadow: inset 0 0 5px rgba(183, 28, 28, 0.2), 0 0 5px rgba(183, 28, 28, 0.2); border-color: var(--blood); }
            50% { box-shadow: inset 0 0 15px rgba(183, 28, 28, 0.5), 0 0 10px rgba(183, 28, 28, 0.4); border-color: #b71c1c; }
        }

        .bingo-cell.active {
            animation: breathe-glow 3s infinite ease-in-out;
        }
        
        .bingo-cell.active::after {
            content: 'é»æ“Šæ­ç¤º';
            position: absolute;
            bottom: 2px;
            font-size: 0.6rem;
            opacity: 0.8;
            font-weight: bold;
            color: var(--blood);
        }

        .modal-overlay {
            background-color: rgba(20, 10, 5, 0.7);
            backdrop-filter: blur(2px);
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .animate-slide-up {
            animation: slideUp 0.5s ease-out forwards;
        }
        
        /* å†’éšªè€…æŒ‰éˆ•é¢¨æ ¼ */
        .btn-rpg {
            position: relative;
            border: 2px solid var(--wood);
            border-radius: 8px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
            box-shadow: 0 4px 0 var(--wood);
        }
        
        .btn-rpg:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 var(--wood);
        }

        .btn-yes {
            background-color: #f1f8e9;
            color: #33691e;
        }
        .btn-yes:hover {
            background-color: #dcedc8;
        }
        
        .btn-no {
            background-color: #ffebee;
            color: #b71c1c;
        }
        .btn-no:hover {
            background-color: #ffcdd2;
        }

        .btn-primary {
            background-color: var(--wood);
            color: #fff8e1;
            border-color: #3e2723;
            box-shadow: 0 4px 0 #3e2723;
        }
        .btn-primary:hover {
            background-color: #4e342e;
        }
        .btn-primary:active {
            box-shadow: 0 0 0 #3e2723;
        }

        .btn-text {
            color: #5d4037;
            text-decoration: underline;
            text-decoration-style: dotted;
            text-underline-offset: 4px;
            font-size: 0.95rem;
            transition: color 0.2s;
        }
        .btn-text:hover {
            color: #3e2723;
        }
        .btn-text:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            text-decoration: none;
        }

        /* é¢¨éšªç­‰ç´šèƒŒæ™¯ */
        .risk-bg-low {
            background-color: #e8f5e9;
            border: 2px solid #66bb6a;
            color: #1b5e20;
        }
        .risk-bg-mid {
            background-color: #fff8e1;
            border: 2px solid #ffca28;
            color: #7f5f02;
        }
        .risk-bg-high {
            background-color: #ffebee;
            border: 2px solid #ef5350;
            color: #b71c1c;
        }

        /* Loading Spinner */
        .loader {
            border: 4px solid #d7ccc8;
            border-top: 4px solid #5d4037; 
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* åœ–ç‰‡é»æ“Šæ•ˆæœ */
        .bark-img {
            transition: transform 0.1s;
        }
        .bark-img:active {
            transform: scale(0.9);
        }

        /* --- å‹•ç•«ç‰¹æ•ˆå®šç¾© --- */
        
        /* è“‹ç« å‹•ç•«ï¼šå¿«é€Ÿæœ‰åŠ›ï¼Œåƒè‚‰çƒå£“ä¸‹å» */
        @keyframes stamp-effect {
            0% { transform: scale(3) rotate(-10deg); opacity: 0; }
            50% { transform: scale(0.9) rotate(-10deg); opacity: 1; }
            100% { transform: scale(1) rotate(-10deg); opacity: 1; }
        }
        .stamp-animate {
            /* ç¸®çŸ­å‹•ç•«æ™‚é–“è‡³ 0.3 ç§’ï¼Œç¬¦åˆã€Œå¿«é€Ÿã€èˆ‡ã€Œè‚‰çƒå½ˆæ€§ã€çš„æ„Ÿè¦º */
            animation: stamp-effect 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        /* å‘å·¦é€å‡ºå‹•ç•«ï¼šä½ç§»ä¸¦æ·¡å‡º */
        @keyframes slide-out-left {
            0% { transform: translateX(0) rotate(0); opacity: 1; }
            100% { transform: translateX(-120%) rotate(-5deg); opacity: 0; }
        }
        .slide-out {
            animation: slide-out-left 0.5s ease-in forwards;
        }

        /* å¾å³é€²å…¥å‹•ç•«ï¼šä½ç§»ä¸¦æ·¡å…¥ */
        @keyframes slide-in-right {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        .slide-in {
            animation: slide-in-right 0.5s ease-out forwards;
        }

    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="w-full max-w-lg scroll-container rounded-3xl overflow-hidden">
        <!-- Header -->
        <header id="app-header" class="wood-grain p-8 text-[#fff8e1] text-center transition-colors duration-500">
            <h1 id="title-text" class="text-3xl font-bold tracking-tight">å†’éšªå…¬æœƒç”Ÿæ´»ç¿’æ…£é‘‘å®š</h1>
            <p id="subtitle-text" class="mt-2 text-[#d7ccc8] italic custom-font">å¾ä½ çš„æ—¥å¸¸ç¿’æ…£ï¼Œç¢ºèªä½ çš„å†’éšªç‹€æ…‹</p>
        </header>

        <main class="p-8 relative z-10">
            <!-- Start Section -->
            <section id="start-section" class="space-y-6">
                <!-- å­—é«”èª¿å°ï¼šå¾ text-lg æ”¹ç‚º text-base -->
                <div class="space-y-4 text-[#4e342e] leading-relaxed text-base">
                    <p>æ–°ä¾†çš„å†’éšªè€…å‘€ï¼Œæ­¡è¿ä¾†åˆ°å…¬æœƒï¼</p>
                    <p>ç‚ºäº†ç¢ºä¿æˆ‘å€‘å…¬æœƒçš„å†’éšªè€…éƒ½èƒ½æ“æœ‰ä¸è¢«è©›å’’çš„å¥åº·èº«é«”ï¼Œæˆ‘å€‘éœ€è¦é€²è¡Œä¸€äº›ç°¡å–®çš„è©•ä¼°ã€‚</p>
                    <p>æ¥ä¸‹ä¾†æˆ‘å€‘æœƒè©¢å•ä½ ä¸€é»ç”Ÿæ´»ç¿’æ…£çš„å•é¡Œï¼Œè«‹ä¾ç…§ä½ æœ€è¿‘ä¸€å€‹æœˆçš„æƒ…æ³å›ç­”ã€‚</p>
                </div>
                <button onclick="startQuiz()" class="w-full py-4 btn-rpg btn-primary text-xl mt-4 custom-font">
                    é–‹å§‹æª¢æ¸¬
                </button>
                
                <!-- ä½œè€…ç°½åèˆ‡é ­åƒå€åŸŸ -->
                <div class="flex items-center justify-end mt-8 gap-3 opacity-90">
                    <div class="text-[#5d4037] text-sm custom-font flex flex-col items-end">
                        <span class="text-xs opacity-70">é‘‘å®šäºº</span>
                        <span class="text-lg signature-font text-2xl">ç‹›å…‹</span>
                    </div>
                    <img src="å°ç‹›å…‹.png" alt="å°ç‹›å…‹" onclick="playBark()" class="bark-img w-10 h-10 rounded-full border-2 border-[#5d4037] shadow-sm bg-[#e6d2b5] object-cover cursor-pointer hover:opacity-80" title="é»æˆ‘è½å«è²">
                </div>
            </section>

            <!-- Quiz Section -->
            <section id="quiz-section" class="hidden space-y-6 overflow-hidden">
                <div class="flex justify-between items-end text-[#5d4037]">
                    <!-- å­—é«”ä¸€è‡´ï¼šç§»é™¤ #current-index çš„ font-serifï¼Œä½¿å…¶ç¹¼æ‰¿çˆ¶å±¤çš„ custom-font -->
                    <span class="text-lg font-bold custom-font">é‘‘å®šé€²åº¦ <span id="current-index">1</span>/16</span>
                    <div class="w-2/3 bg-[#d7ccc8] h-3 rounded-full overflow-hidden border border-[#8d6e63]">
                        <div id="progress-bar" class="bg-[#8d6e63] h-full transition-all duration-300" style="width: 6.25%"></div>
                    </div>
                </div>
                
                <!-- é¡Œç›®å¡ç‰‡å®¹å™¨ï¼Œç”¨æ–¼åŸ·è¡Œå‹•ç•« -->
                <div id="question-card" class="relative">
                    
                    <!-- å°ç« å…ƒç´ ï¼šè‚‰çƒSVG -->
                    <div id="decision-stamp" class="absolute hidden w-20 h-20 pointer-events-none z-20 text-[#8a1c1c] opacity-90 origin-center">
                        <svg viewBox="0 0 100 100" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <!-- ä¸»è‚‰å¢Š -->
                            <path d="M50 85 C35 85, 25 70, 30 60 C35 50, 65 50, 70 60 C75 70, 65 85, 50 85 Z" />
                            <!-- å››å€‹è…³è¶¾ -->
                            <ellipse cx="20" cy="45" rx="10" ry="14" transform="rotate(-20 20 45)" />
                            <ellipse cx="40" cy="30" rx="10" ry="14" transform="rotate(-10 40 30)" />
                            <ellipse cx="60" cy="30" rx="10" ry="14" transform="rotate(10 60 30)" />
                            <ellipse cx="80" cy="45" rx="10" ry="14" transform="rotate(20 80 45)" />
                        </svg>
                    </div>

                    <div class="min-h-[140px] flex items-center justify-center bg-[#efebe9] rounded-xl border-2 border-[#d7ccc8] p-4 shadow-inner">
                        <h2 id="question-text" class="text-2xl font-bold text-[#3e2723] leading-relaxed text-center">ç¿»æ‰¾å·è»¸ä¸­...</h2>
                    </div>

                    <div class="grid grid-cols-2 gap-6 mt-6">
                        <!-- å‚³å…¥ event ä»¥ä¾¿è¨ˆç®—åº§æ¨™ -->
                        <button onclick="handleAnswerClick(true, event)" class="btn-rpg btn-yes py-6 text-xl custom-font relative overflow-hidden">æ˜¯ (Yes)</button>
                        <button onclick="handleAnswerClick(false, event)" class="btn-rpg btn-no py-6 text-xl custom-font relative overflow-hidden">å¦ (No)</button>
                    </div>
                </div>

                <div class="flex justify-start pt-2">
                    <button id="prev-btn" onclick="prevQuestion()" class="btn-text custom-font" disabled>
                        â†º å›åˆ°ä¸Šä¸€é¡Œ
                    </button>
                </div>
            </section>

            <!-- Loading Section -->
            <section id="loading-section" class="hidden flex flex-col items-center justify-center py-12 space-y-6">
                <div class="loader"></div>
                <p class="text-[#5d4037] font-bold text-xl animate-pulse custom-font">æ­£åœ¨é‘‘å®š...</p>
            </section>

            <!-- Result Section -->
            <section id="result-section" class="hidden animate-slide-up space-y-6 text-center">
                
                <!-- æ­éœ²è§£é‡‹å€å¡Š -->
                <div class="bg-[#fff3e0] p-6 rounded-xl border-2 border-[#ffb74d] text-left space-y-3 shadow-md">
                    <h3 class="text-xl font-bold text-[#e65100] flex items-center gap-2">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        é€™å…¶å¯¦æ˜¯ä¸€ä»½ã€Œå¿ƒéˆé˜²ç¦¦å€¼ã€é‘‘å®šï¼
                    </h3>
                    <!-- å­—é«”èª¿å°ï¼šå¾ text-lg æ”¹ç‚º text-base -->
                    <p class="text-base text-[#bf360c] leading-relaxed">
                        ç‚ºä»€éº¼ã€Œå–æ°´ã€ã€ã€Œåƒæ—©é¤ã€æœƒè·Ÿå¿ƒç†é˜²ç¦¦å€¼æœ‰é—œï¼Ÿ<br><br>
                        é€™ä»½åœ°åœ–æ­éœ²çš„æ˜¯é‚£äº›<b>çœ‹ä¼¼å¾®ä¸è¶³é“ã€å»èƒ½ç©æ²™æˆå¡”å½±éŸ¿å¤§è…¦ç¥ç¶“å‚³å°çš„ç”Ÿæ´»ç¿’æ…£</b>ã€‚åœ¨é‘‘å®šä¸­çš„æ‰€æœ‰é¡Œç›®ï¼Œéƒ½è·Ÿæ†‚é¬±çš„é¢¨éšªæœ‰é—œï¼<br>
                        è¨±å¤šæ™‚å€™å¿ƒéˆç ´é˜²ä¸æ˜¯å› ç‚ºè¢«å¾ˆå²å®³çš„æ€ªç‰©æ‰€æ‰“ç¢ï¼Œåè€Œå¯èƒ½æ˜¯è¢«é€™äº›æ—¥å¸¸çš„Debuffæ…¢æ…¢ä¾µè•æ‰çš„ï¼
                    </p>
                </div>

                <div class="bg-[#d7ccc8] p-4 rounded-xl border-2 border-[#8d6e63]">
                    <div id="bingo-board" class="bingo-grid mb-4 custom-font">
                        <!-- JS generated grid -->
                    </div>
                    
                    <!-- çµæœæ•¸æ“š -->
                    <div class="flex justify-between text-base px-4 py-3 bg-[#efebe9] rounded-lg border border-[#a1887f] mb-4">
                        <p class="text-[#5d4037] font-bold custom-font">é¢¨éšªæ¨™è¨˜ï¼š<span id="risk-score" class="text-[#b71c1c] text-xl font-serif">0</span></p>
                        <p class="text-[#5d4037] font-bold custom-font">é€£ç·šè©›å’’ï¼š<span id="line-score" class="text-[#b71c1c] text-xl font-serif">0</span></p>
                    </div>

                    <!-- å‹•æ…‹å»ºè­°å€å¡Šï¼šèƒŒæ™¯è‰²æœƒç”± JS æ§åˆ¶ -->
                    <div id="advice-container" class="text-left space-y-3 p-4 rounded-xl shadow-inner transition-colors duration-500">
                        <!-- å­—é«”èª¿å°ï¼šæ”¹ç‚º text-sm -->
                        <p class="text-sm leading-relaxed"><span class="font-bold text-lg border-b border-current inline-block mb-1 custom-font">ğŸ“œ å…¬æœƒç¶œåˆè©•ä¼°ï¼š</span><br><span id="score-advice"></span></p>
                        <p class="text-sm leading-relaxed mt-2 pt-2 border-t border-current/20"><span class="font-bold text-lg border-b border-current inline-block mb-1 custom-font">ğŸ”— é—œæ–¼é€£ç·šï¼š</span><br><span id="bingo-advice"></span></p>
                    </div>
                </div>

                <div class="text-[#1a237e] font-bold text-base bg-[#e8eaf6] py-3 rounded-lg border border-[#c5cae9] custom-font">
                    ğŸ‘† é»æ“Šç™¼å…‰çš„ç´…è‰²æ ¼å­ï¼Œçœ‹çœ‹å®ƒå°å¤§è…¦çš„å½±éŸ¿ï¼
                </div>

                <!-- æ†‚é¬±å‚¾å‘é—œæ‡·å€å¡Š -->
                <div class="mt-6 p-5 bg-white/60 rounded-xl border border-[#d7ccc8] text-left text-sm text-[#5d4037] shadow-sm">
                    <p class="font-bold text-base mb-2 flex items-center gap-2 custom-font">
                        ğŸ’¡ çµ¦å†’éšªè€…çš„ä¾¿æ¢ç´™ï¼š
                    </p>
                    <p class="leading-relaxed">
                        å¦‚æœä½ è¦ºå¾—é€™ä»½æ¸¬é©—çµæœè®“ä½ æ„Ÿè¦ºæœ‰é»ä¸å®‰ï¼Œæˆ–è€…ä½ å·²ç¶“è¦ºå¾—æƒ…ç·’ä½è½ã€å°äº‹ç‰©å¤±å»èˆˆè¶£å¾ˆä¹…äº†ï¼Œè«‹è¨˜å¾—å°‹æ±‚å°ˆæ¥­çš„èº«å¿ƒç§‘é†«å¸«æˆ–å¿ƒç†è«®å•†å¸«å”åŠ©ã€‚

                    </p>
                    <p class="leading-relaxed mt-2 font-bold text-[#8a1c1c]">
                        ç‚ºäº†èµ°æ›´é•·é çš„è·¯ï¼Œè£å‚™ä¿é¤Šæ˜¯å¿…è¦çš„ã€‚èº«é«”å›ºç„¶é‡è¦ï¼Œä½†å¯åˆ¥å¿˜è¨˜ç¶­è­·å¿ƒéˆé€™ä»¶ç„¡å½¢è£å‚™ï¼
                    </p>
                </div>

                <div class="pt-4 flex justify-between items-center">
                    <button onclick="location.reload()" class="text-[#8d6e63] text-base hover:text-[#5d4037] underline decoration-dotted underline-offset-4 custom-font">é‡æ–°æŒ‘æˆ°</button>
                    <!-- ä½œè€…ç°½åèˆ‡é ­åƒå€åŸŸ (Footer) -->
                    <div class="flex items-center gap-2 opacity-80 scale-90 origin-right">
                        <div class="text-[#5d4037] text-sm custom-font text-right">
                            <span class="block text-xs opacity-70">é‘‘å®šäºº</span>
                            <span class="block signature-font text-2xl">ç‹›å…‹</span>
                        </div>
                        <img src="å°ç‹›å…‹.png" alt="å°ç‹›å…‹" onclick="playBark()" class="bark-img w-8 h-8 rounded-full border border-[#5d4037] bg-[#e6d2b5] object-cover cursor-pointer hover:opacity-80" title="é»æˆ‘è½å«è²">
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal -->
    <div id="detail-modal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
        <div class="scroll-container w-full max-w-md rounded-2xl shadow-2xl overflow-hidden animate-slide-up transform transition-all relative">
            <div class="bg-[#efebe9] p-4 border-b-2 border-[#d7ccc8] flex justify-between items-center">
                <h3 id="modal-title" class="text-2xl font-bold text-[#3e2723]">æ¨™é¡Œ</h3>
                <button onclick="closeModal()" class="w-8 h-8 flex items-center justify-center rounded-full bg-[#d7ccc8] text-[#5d4037] hover:bg-[#bcaaa4] font-bold text-xl">&times;</button>
            </div>
            <div class="p-6 space-y-6 max-h-[70vh] overflow-y-auto">
                <div>
                    <h4 class="flex items-center gap-2 text-lg font-bold text-[#c62828] uppercase tracking-wider mb-2 border-b border-[#c62828] pb-1 custom-font">
                        âš ï¸ é¢¨éšªæ©Ÿåˆ¶
                    </h4>
                    <!-- å­—é«”èª¿å°ï¼šå¾ text-lg æ”¹ç‚º text-base -->
                    <p id="modal-impact" class="text-[#4e342e] leading-relaxed text-base"></p>
                </div>
                <div class="bg-[#e3f2fd] p-5 rounded-xl border border-[#90caf9]">
                    <h4 class="flex items-center gap-2 text-base font-bold text-[#1565c0] uppercase tracking-wider mb-2 custom-font">
                        ğŸ“– è³¢è€…çš„æ–‡ç»
                    </h4>
                    <!-- å­—é«”èª¿å°ï¼šå¾ text-base æ”¹ç‚º text-sm -->
                    <p id="modal-evidence" class="text-[#0d47a1] text-sm italic leading-relaxed font-serif"></p>
                </div>
            </div>
            <div class="p-4 border-t-2 border-[#d7ccc8] bg-[#efebe9]">
                <button onclick="closeModal()" class="w-full py-3 btn-rpg btn-primary text-lg custom-font">æ”¶ä¸‹é€™å‰‡çŸ¥è­˜</button>
            </div>
        </div>
    </div>

    <script>
        // éŸ³æ•ˆæ’­æ”¾
        function playBark() {
            try {
                const audio = new Audio('bark.mp3');
                audio.play();
            } catch (e) {
                console.log("Audio play failed, maybe user interaction is needed first.");
            }
        }

        // å®šç¾©é¡Œåº«èˆ‡ Bingo ç‰ˆé¢é…ç½®
        const bingoLayout = [
            // Row 1
            { id: 2, tag: "ç¡çœ ä¸è¶³", q: "ä½ æ¯å¤©çš„ç¡çœ æ™‚é–“æ˜¯å¦å¤§å¤šç¶­æŒåœ¨ 6-8 å°æ™‚ï¼Ÿ", isReverse: true, impact: "ç¡çœ ä¸è¶³æœƒå‰Šå¼±å‰é¡è‘‰çš®è³ªå°æä»æ ¸çš„æ§åˆ¶ï¼Œå°è‡´æƒ…ç·’åæ‡‰éåº¦ï¼Œæ˜¯æ†‚é¬±ç—‡çš„æœ€å¼·é æ¸¬æŒ‡æ¨™ä¹‹ä¸€ã€‚", evidence: "ä¸€é …å¤§å‹ Meta åˆ†ææŒ‡å‡ºï¼Œæ¯æ™šç¡çœ ä¸è¶³ 6 å°æ™‚çš„äººï¼Œæ‚£ä¸Šé‡åº¦æ†‚é¬±ç—‡çš„å¯èƒ½æ€§æ¯”ä¸€èˆ¬äººé«˜å‡º 2 å€ã€‚" },
            { id: 14, tag: "è¥¿å¼é£²é£Ÿ", q: "å¹³å¸¸é£²é£Ÿä¸­ï¼Œä½ æ˜¯å¦è¼ƒå°‘æ”å–è”¬èœã€é­šé¡ï¼Œè€Œä»¥è‚‰é¡æˆ–æ¾±ç²‰ç‚ºä¸»ï¼Ÿ", isReverse: false, impact: "è¥¿å¼é£²é£Ÿç¼ºä¹ Omega-3 èˆ‡ç›Šç”Ÿè³ªï¼Œæœƒå°è‡´è…¸é“èŒå¢å¤±è¡¡ï¼ˆè…¸è…¦è»¸ï¼‰ï¼Œé€™è¢«èªç‚ºèˆ‡æƒ…ç·’éšœç¤™æœ‰ç›´æ¥é—œä¿‚ã€‚", evidence: "æ ¹æ“šå¤§å‹éšŠåˆ—ç ”ç©¶ï¼Œæ¡å–è¥¿å¼é£²é£Ÿè€…çš„æ†‚é¬±é¢¨éšªæ¯”åœ°ä¸­æµ·é£²é£Ÿè€…ï¼ˆè”¬èœã€æ©„æ¬–æ²¹ã€é­šï¼‰é«˜å‡º 41%ã€‚" },
            { id: 9, tag: "é•·é€”é€šå‹¤", q: "ä½ æ¯å¤©çš„é€šå‹¤æ™‚é–“ï¼ŒèŠ±åœ¨äº¤é€šå·¥å…·ä¸Šçš„æ™‚é–“æ˜¯å¦è¶…é 90 åˆ†é˜ï¼Ÿ", isReverse: false, impact: "é•·é€”é€šå‹¤æœƒæ¸›å°‘ç¡çœ èˆ‡é‹å‹•æ™‚é–“ï¼Œä¸¦å¢åŠ æš´éœ²åœ¨äº¤é€šå™ªéŸ³èˆ‡ç’°å¢ƒå£“åŠ›ä¸‹çš„é »ç‡ã€‚", evidence: "ç ”ç©¶ç™¼ç¾ï¼Œé€šå‹¤è¶…é 45 åˆ†é˜çš„å‹å·¥ï¼Œåœ¨ç”Ÿæ´»æ»¿æ„åº¦ä¸Šé¡¯è‘—è¼ƒä½ï¼Œä¸”å¿ƒç†å¥åº·é¢¨éšªæå‡äº† 15% åˆ° 20%ã€‚" },
            { id: 4, tag: "ç¨å±…ç”Ÿæ´»", q: "ä½ è‡ªå·±ä¸€å€‹äººä½ï¼Œæˆ–æ˜¯å¾ˆå°‘æœ‰èˆ‡å®¶äººèˆ‡å®¤å‹äº¤æµçš„æ©Ÿæœƒå—ï¼Ÿ", isReverse: false, impact: "ç¨å±…å¸¸å°è‡´ç¤¾äº¤éš”é›¢ï¼ˆSocial Isolationï¼‰ï¼Œç¼ºä¹ç·©è¡å£“åŠ›çš„æƒ…ç·’å‡ºå£ï¼Œæ˜¯å¤§è…¦ã€Œå¯‚å¯ä¸­æ¨ã€æ´»èºçš„ä¸»å› ã€‚", evidence: "ã€ŠPLOS ONEã€‹ç ”ç©¶æŒ‡å‡ºï¼Œç¨å±…è€…ç›¸å°æ–¼éç¨å±…è€…ï¼Œä½¿ç”¨æŠ—æ†‚é¬±åŠ‘çš„æ©Ÿç‡é«˜å‡º 80% ä»¥ä¸Šã€‚" },

            // Row 2
            { id: 7, tag: "å¸¸åƒé€Ÿé£Ÿ", q: "ä½ æ¯é€±åƒç‚¸é›ã€æ¼¢å ¡ã€æŠ«è–©ç­‰é€Ÿé£Ÿçš„é »ç‡æ˜¯å¦è¶…é 3 æ¬¡ï¼Ÿ", isReverse: false, impact: "é€Ÿé£Ÿå«æœ‰å¤§é‡åå¼è„‚è‚ªèˆ‡åŠ å·¥æ²¹å“ï¼Œæœƒæå‚·è¡€è…¦å±éšœï¼Œå½±éŸ¿ç¶­æŒæƒ…ç·’ç©©å®šçš„ç¥ç¶“é€šè·¯ã€‚", evidence: "ç™¼è¡¨æ–¼ã€ŠPublic Health Nutritionã€‹çš„ç ”ç©¶é¡¯ç¤ºï¼Œå¸¸åƒé€Ÿé£Ÿè€…ç½¹æ‚£æ†‚é¬±ç—‡çš„é¢¨éšªæ¯”ä¸åƒè€…é«˜å‡ºç´„ 51%ã€‚" },
            { id: 1, tag: "ä¸åƒæ—©é¤", q: "ä½ æ˜¯å¦æœ‰æ¯å¤©è¦å¾‹åƒæ—©é¤çš„ç¿’æ…£ï¼Ÿ", isReverse: true, impact: "ä¸åƒæ—©é¤æœƒå°è‡´è¡€ç³–æ³¢å‹•ä¸ç©©ï¼Œä¸¦å¹²æ“¾çš®è³ªé†‡ï¼ˆå£“åŠ›è·çˆ¾è’™ï¼‰çš„è‡ªç„¶ç¯€å¾‹ï¼Œé€²è€Œå½±éŸ¿æƒ…ç·’èª¿ç¯€ã€‚", evidence: "ã€ŠJournal of Affective Disordersã€‹ç ”ç©¶é¡¯ç¤ºï¼Œèˆ‡æ¯å¤©åƒæ—©é¤çš„äººç›¸æ¯”ï¼Œä¸åƒæ—©é¤çš„äººæ‚£æ†‚é¬±ç—‡çš„é¢¨éšªå¢åŠ äº†ç´„ 73%ã€‚" },
            { id: 6, tag: "å—œåƒç”œé£Ÿ", q: "ä½ æ¯å¤©éƒ½æœƒå–å«ç³–é£²æ–™ã€æ‰‹æ–é£²æˆ–åƒç”œé»å—ï¼Ÿ", isReverse: false, impact: "éé‡ç³–åˆ†æœƒå¼•ç™¼é«”å…§æ…¢æ€§ç™¼ç‚ï¼Œä¸¦å°è‡´è…¦æºæ€§ç¥ç¶“ç‡Ÿé¤Šå› å­ï¼ˆBDNFï¼‰ä¸‹é™ï¼Œé€™èˆ‡æ†‚é¬±ç—‡çš„ç”Ÿç†æ©Ÿåˆ¶é«˜åº¦ç›¸é—œã€‚", evidence: "æ ¹æ“šç™¼è¡¨æ–¼ã€ŠBMC Psychiatryã€‹çš„çµ±åˆåˆ†æè«–æ–‡æŒ‡å‡ºï¼Œé«˜ç³–æ”å–é‡èˆ‡æ†‚é¬±é¢¨éšªé¡¯è‘—ç›¸é—œã€‚" },
            { id: 12, tag: "å‡æ—¥è£œçœ ", q: "æ”¾å‡æ™‚ï¼Œä½ çš„èµ·åºŠæ™‚é–“æ˜¯å¦é€šå¸¸æ¯”å¹³æ—¥ä¸Šç­ä¸Šèª²æ™‚é–“æ™š 2 å°æ™‚ä»¥ä¸Šï¼Ÿ", isReverse: false, impact: "é€™ç¨±ç‚ºã€Œç¤¾äº¤æ™‚å·® (Social Jetlag)ã€ï¼Œæœƒå°è‡´æ™å¤œç¯€å¾‹ç´Šäº‚ï¼Œé€™èˆ‡å…§å› æ€§æ†‚é¬±ç—‡æœ‰å¼·çƒˆå› æœéˆçµã€‚", evidence: "ç ”ç©¶é¡¯ç¤ºï¼Œæ¯å¢åŠ  1 å°æ™‚çš„ç¤¾äº¤æ™‚å·®ï¼Œç½¹æ‚£æ†‚é¬±æˆ–ç„¦æ…®ç—‡ç‹€çš„é¢¨éšªå°±æœƒå¢åŠ ç´„ 20% åˆ° 25%ã€‚" },

            // Row 3
            { id: 10, tag: "éƒ½å¸‚ç”Ÿæ´»", q: "ä½ ç›®å‰çš„å±…ä½ç’°å¢ƒæ˜¯å¦ä½æ–¼äººå¤šè»Šå¤šã€è¼ƒç‚ºåµé›œçš„å¸‚ä¸­å¿ƒå€åŸŸï¼Ÿ", isReverse: false, impact: "éƒ½å¸‚ç’°å¢ƒä¼´éš¨è‘—é«˜å¯†åº¦çš„ç¤¾æœƒå£“åŠ›ã€ç©ºæ°£æ±™æŸ“èˆ‡å¾®é‡å™ªéŸ³ï¼Œé€™äº›éƒ½æœƒè®“å£“åŠ›æ‡‰å°ç³»çµ±éè¼‰ã€‚", evidence: "ã€ŠNatureã€‹ç™¼è¡¨çš„ç ”ç©¶æŒ‡å‡ºï¼Œå±…ä½åœ¨éƒ½å¸‚ä¸­å¿ƒçš„äººï¼Œå¤§è…¦è™•ç†å£“åŠ›çš„å€åŸŸï¼ˆå¦‚æä»æ ¸ï¼‰æ¯”å±…ä½è¾²æ‘çš„äººæ›´å®¹æ˜“åæ‡‰éåº¦ï¼Œæ†‚é¬±é¢¨éšªé«˜å‡º 39%ã€‚" },
            { id: 3, tag: "é«”é‡ç•°å¸¸", q: "ä½ çš„ BMI æŒ‡æ•¸æ˜¯å¦åœ¨18.5 ~ 24ä¹‹é–“ï¼Ÿ", isReverse: true, impact: "ç•°å¸¸çš„é«”é‡ç‹€æ…‹å¸¸ä¼´éš¨æ…¢æ€§ç™¼ç‚åæ‡‰ï¼ˆéèƒ–ï¼‰æˆ–ç‡Ÿé¤Šç´ ç¼ºä¹ï¼ˆéç˜¦ï¼‰ï¼Œé€™äº›ç”Ÿç†å› ç´ æœƒç›´æ¥å¹²æ“¾ç¥ç¶“å‚³å°ç‰©è³ªã€‚", evidence: "ç ”ç©¶ç™¼ç¾ï¼Œè‚¥èƒ–è€…çš„æ†‚é¬±é¢¨éšªå¢åŠ  55%ï¼›è€Œé«”é‡éè¼•è€…ï¼ˆå°¤å…¶æ˜¯ç”·æ€§ï¼‰çš„å¿ƒç†å¥åº·å•é¡Œé¢¨éšªäº¦é¡¯è‘—æå‡ç´„ 30%ã€‚" },
            { id: 13, tag: "é–‹ç‡ˆç¡è¦º", q: "ç¡è¦ºæ™‚ï¼Œä½ çš„æˆ¿é–“æ˜¯å¦ä»æœ‰å°å¤œç‡ˆï¼Œæˆ–çª—å¤–æœ‰è·¯ç‡ˆå…‰ç·šé€å…¥ï¼Ÿ", isReverse: false, impact: "å¾®å¼±å…‰ç·šä¹Ÿæœƒåœ¨ç¡çœ ä¸­å£“æŠ‘è¤ªé»‘æ¿€ç´ ï¼Œä¸¦å¹²æ“¾ä¸‹è¦–ä¸˜çš„æƒ…ç·’èª¿ç¯€åŠŸèƒ½ã€‚", evidence: "ã€ŠAmerican Journal of Epidemiologyã€‹ç ”ç©¶ç™¼ç¾ï¼Œç¡è¦ºæ™‚æœ‰å…‰ç…§è€…ï¼Œä¸‰å¹´å¾Œå‡ºç¾åš´é‡æ†‚é¬±ç—‡ç‹€çš„æ©Ÿç‡å¢åŠ è¿‘ 2 å€ã€‚" },
            { id: 11, tag: "é£²æ°´ä¸è¶³", q: "ä½ æœ‰æ¯å¤©å–å¤  1500cc ä»¥ä¸Šç™½é–‹æ°´çš„ç¿’æ…£å—ï¼Ÿ", isReverse: true, impact: "å¤§è…¦ 80% æ˜¯æ°´åˆ†ï¼Œè¼•å¾®è„«æ°´å³æœƒå½±éŸ¿å¤§è…¦è¡€æµé‡èˆ‡æƒ…ç·’å¹³ç©©ï¼Œè®“äººæ›´å®¹æ˜“æ„Ÿåˆ°ç„¦èºèˆ‡ä½è½ã€‚", evidence: "ã€ŠWorld Journal of Psychiatryã€‹ç ”ç©¶æŒ‡å‡ºï¼Œæ¯æ—¥é£²æ°´ä¸è¶³è€…ï¼Œç„¦æ…®èˆ‡æ†‚é¬±çš„é¢¨éšªåˆ†åˆ¥å¢åŠ äº† 73% èˆ‡ 79%ã€‚" },
            
            // Row 4
            { id: 5, tag: "ä¹…åä¸å‹•", q: "ä½ æ¯å¤©åè‘—çš„æ™‚é–“ï¼Œæ˜¯å¦è¶…é 8 å°æ™‚ï¼Ÿ", isReverse: false, impact: "ä¹…åæœƒæŠ‘åˆ¶å¾ªç’°ä¸¦æ¸›å°‘è…¦è¡ç”Ÿç¥ç¶“ç‡Ÿé¤Šå› å­ (BDNF) çš„ç”¢ç”Ÿï¼Œé€™é¡å› å­è² è²¬å¤§è…¦ç¥ç¶“å…ƒä¿®å¾©ã€‚", evidence: "ä¸€é …è¿½è¹¤ç ”ç©¶é¡¯ç¤ºï¼Œæ¯å¤©ä¹…åè¶…é 12 å°æ™‚çš„äººï¼Œå…¶ç½¹æ‚£æ†‚é¬±ç—‡çš„é¢¨éšªæ¯”ä¹…åå°‘æ–¼ 4 å°æ™‚çš„äººé«˜å‡º 3 å€ã€‚" },
            { id: 15, tag: "è¢«å‹•ç¤¾ç¾¤", q: "æ»‘ç¤¾ç¾¤è»Ÿé«”æ™‚ï¼Œä½ æ˜¯å¦é€šå¸¸åªç€è¦½å‹•æ…‹è·ŸæŒ‰è®šï¼Œè€Œå¾ˆå°‘ç•™è¨€æˆ–ç™¼æ–‡ï¼Ÿ", isReverse: false, impact: "åªæ»‘å‹•æ…‹è€Œæ²’æœ‰äº’å‹•ï¼Œé€™è¢«ç¨±ç‚ºè¢«å‹•ä½¿ç”¨ç¤¾äº¤è»Ÿé«”ï¼Œé€™æ¨£çš„ä½¿ç”¨æ–¹å¼æœƒç”¢ç”Ÿã€Œå‘ä¸Šç¤¾æœƒæ¯”è¼ƒã€ï¼Œé€²è€Œå¼•ç™¼æ¥µåº¦çš„å­¤ç¨æ„Ÿèˆ‡è‡ªæˆ‘åƒ¹å€¼å¦å®šã€‚", evidence: "ç ”ç©¶æŒ‡å‡ºï¼Œè¢«å‹•ä½¿ç”¨ç¤¾ç¾¤åª’é«”è€…çš„æ†‚é¬±å‚¾å‘ï¼Œæ¯”ä¸»å‹•åƒèˆ‡äº’å‹•çš„ä½¿ç”¨è€…é«˜å‡º 33%ã€‚" },
            { id: 16, tag: "éåº¦è¿½åŠ‡", q: "ä½ æ˜¯å¦æ¯å¤©è¿½åŠ‡æˆ–çœ‹çŸ­å½±éŸ³è¶…é 3 å°æ™‚ä»¥ä¸Šï¼Œè€Œä¸”è€æ˜¯åœä¸ä¸‹ä¾†ï¼Ÿ", isReverse: false, impact: "é€£çºŒè¿½åŠ‡æœƒå°è‡´ã€Œæƒ…ç·’æ…£æ€§ã€ï¼ŒçµæŸå¾Œçš„ç©ºè™›æ„Ÿèˆ‡ä¹…åã€ç¡çœ æ¨é²æœƒå½¢æˆè² é¢å¾ªç’°ã€‚", evidence: "ã€ŠThe Journal of Clinical Sleep Medicineã€‹æŒ‡å‡ºï¼Œéåº¦è¿½åŠ‡è€…æ‚£æœ‰å¤±çœ ã€ç„¦æ…®èˆ‡æ†‚é¬±çš„å¯èƒ½æ€§é¡¯è‘—å¢åŠ  1.4 å€ã€‚" },
            { id: 8, tag: "æ‰‹æ©Ÿæˆç™®", q: "é™¤äº†å·¥ä½œéœ€æ±‚ï¼Œä½ æ¯å¤©æ»‘æ‰‹æ©Ÿæˆ–å¹³æ¿çš„æ™‚é–“æ˜¯å¦è¶…é 4 å°æ™‚ï¼Ÿ", isReverse: false, impact: "éåº¦ä½¿ç”¨æ‰‹æ©Ÿå¸¸ä¼´éš¨æ•¸ä½å£“åŠ›å’Œç¤¾äº¤æ¯”è¼ƒï¼Œä¸¦æœƒå› éé‡è—å…‰æš´éœ²è€Œå£“æŠ‘è¡€æ¸…ç´ åˆ†æ³Œã€‚", evidence: "éŸ“åœ‹ä¸€é …é‡å° 5 è¬äººçš„ç ”ç©¶æŒ‡å‡ºï¼Œæ‰‹æ©Ÿæˆç™®åº¦é«˜çš„ç¾¤é«”ï¼Œå…¶é‡åº¦æ†‚é¬±ç—‡å€™ç¾¤é¢¨éšªæ¯”ä½åº¦ä½¿ç”¨è€…é«˜å‡º 2.8 å€ã€‚" }
        ];

        let quizOrder = [];
        let currentStep = 0;
        let userRisks = new Array(16).fill(false);
        let isAnimating = false; // é˜²æ­¢é‡è¤‡é»æ“Š

        function startQuiz() {
            quizOrder = Array.from({length: 16}, (_, i) => i).sort(() => Math.random() - 0.5);
            currentStep = 0;
            userRisks = new Array(16).fill(false);
            isAnimating = false;

            document.getElementById('start-section').classList.add('hidden');
            document.getElementById('quiz-section').classList.remove('hidden');
            
            // ç¢ºä¿å¡ç‰‡åœ¨åˆå§‹ä½ç½®
            const card = document.getElementById('question-card');
            card.className = "relative"; 
            
            renderQuestion();
        }

        function renderQuestion() {
            const layoutIndex = quizOrder[currentStep];
            const qData = bingoLayout[layoutIndex];
            
            document.getElementById('question-text').innerText = qData.q;
            document.getElementById('current-index').innerText = currentStep + 1;
            document.getElementById('progress-bar').style.width = `${((currentStep + 1) / 16) * 100}%`;
            
            // æ§åˆ¶ä¸Šä¸€é¡ŒæŒ‰éˆ•
            const prevBtn = document.getElementById('prev-btn');
            if (currentStep > 0) {
                prevBtn.disabled = false;
            } else {
                prevBtn.disabled = true;
            }
        }

        // ä¿®æ”¹å¾Œçš„æŒ‰éˆ•é»æ“Šè™•ç†
        function handleAnswerClick(userAnswer, event) {
            if (isAnimating) return; // å‹•ç•«ä¸­ç¦æ­¢æ“ä½œ
            isAnimating = true;

            const stamp = document.getElementById('decision-stamp');
            const card = document.getElementById('question-card');
            
            // è¨ˆç®—é»æ“ŠæŒ‰éˆ•çš„ä¸­å¿ƒä½ç½®
            const btn = event.currentTarget;
            const btnRect = btn.getBoundingClientRect();
            const cardRect = card.getBoundingClientRect();
            
            // ç›¸å°æ–¼å¡ç‰‡çš„ top/left
            const stampTop = btnRect.top - cardRect.top + (btnRect.height / 2);
            const stampLeft = btnRect.left - cardRect.left + (btnRect.width / 2);

            // è¨­å®šå°ç« ä½ç½®
            stamp.style.top = `${stampTop}px`;
            stamp.style.left = `${stampLeft}px`;
            // ç§»é™¤ hiddenï¼Œæ·»åŠ å‹•ç•« class
            stamp.classList.remove('hidden');
            stamp.classList.add('stamp-animate');

            // 2. å»¶é²å¾ŒåŸ·è¡Œå¡ç‰‡æ»‘å‡º (0.4ç§’å¾Œ)
            setTimeout(() => {
                card.classList.add('slide-out');
            }, 400); 

            // 3. å»¶é²å¾Œæ›´æ–°æ•¸æ“šã€æ»‘å…¥æ–°é¡Œç›® (0.4 + 0.5 ç§’å·¦å³)
            setTimeout(() => {
                // è¨˜éŒ„ç­”æ¡ˆ (åœ¨è¦–è¦ºåˆ‡æ›çš„åŒæ™‚æ›´æ–°é‚è¼¯)
                recordAnswerLogic(userAnswer);

                if (currentStep < 15) {
                    currentStep++;
                    
                    // æº–å‚™ä¸‹ä¸€é¡Œå…§å®¹
                    renderQuestion();

                    // é‡ç½®å‹•ç•«ç‹€æ…‹
                    stamp.classList.remove('stamp-animate'); 
                    stamp.classList.add('hidden'); // éš±è—å°ç« ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡é»æ“Š
                    
                    // ç§»é™¤æ»‘å‡ºé¡
                    card.classList.remove('slide-out');
                    
                    // å¼·åˆ¶ç€è¦½å™¨é‡ç¹ª (Reflow)ï¼Œç¢ºä¿å‹•ç•«é‡ç½®
                    void card.offsetWidth;

                    // æ·»åŠ æ»‘å…¥é¡
                    card.classList.add('slide-in');

                    // ç›£è½æ»‘å…¥å‹•ç•«çµæŸï¼Œæ¸…ç†ç‹€æ…‹
                    const onSlideInEnd = () => {
                        card.classList.remove('slide-in');
                        isAnimating = false;
                        card.removeEventListener('animationend', onSlideInEnd);
                    };
                    card.addEventListener('animationend', onSlideInEnd);

                } else {
                    startLoading();
                }
            }, 900); // 400ms(è“‹ç« ç­‰å¾…) + 500ms(æ»‘å‡º)
        }

        // åƒ…è™•ç†æ•¸æ“šè¨˜éŒ„ï¼Œä¸è² è²¬ UI è½‰å ´
        function recordAnswerLogic(userAnswer) {
            const layoutIndex = quizOrder[currentStep];
            const qData = bingoLayout[layoutIndex];

            let isRisk = false;
            if (qData.isReverse) {
                isRisk = !userAnswer;
            } else {
                isRisk = userAnswer;
            }
            userRisks[layoutIndex] = isRisk;
        }

        function prevQuestion() {
            if (currentStep > 0 && !isAnimating) {
                currentStep--;
                // ä¸Šä¸€é¡Œç›´æ¥æ¸²æŸ“ï¼Œä¸ä¸€å®šè¦ç‰¹æ•ˆï¼Œæˆ–è€…å¯ä»¥åšåå‘ç‰¹æ•ˆï¼ˆé€™è£¡ç°¡åŒ–è™•ç†ï¼‰
                renderQuestion();
            }
        }

        function startLoading() {
            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('loading-section').classList.remove('hidden');
            
            // æ¨¡æ“¬ 1 ç§’è¼‰å…¥æ™‚é–“
            setTimeout(() => {
                document.getElementById('loading-section').classList.add('hidden');
                showResults();
            }, 1000);
        }

        function showResults() {
            document.getElementById('result-section').classList.remove('hidden');
            
            document.getElementById('title-text').innerText = "å†’éšªå ±å‘Šæ›¸å®Œæˆ";
            document.getElementById('subtitle-text').innerText = "é»æ“Šç¾Šçš®ç´™ä¸Šçš„å°è¨˜ï¼Œè§£è®€é¢¨éšªèƒŒå¾Œçš„æ©Ÿåˆ¶";

            renderBingo();
            calculateBingoAndGiveAdvice();
        }

        function renderBingo() {
            const board = document.getElementById('bingo-board');
            board.innerHTML = '';
            
            bingoLayout.forEach((item, index) => {
                const cell = document.createElement('div');
                const isRisk = userRisks[index];
                
                cell.className = `bingo-cell ${isRisk ? 'active' : ''}`;
                cell.innerText = item.tag;
                cell.onclick = () => { openModal(index); };
                board.appendChild(cell);
            });
        }

        function calculateBingoAndGiveAdvice() {
            let lines = 0;
            const riskCount = userRisks.filter(r => r).length;
            const grid = [];
            
            for (let i = 0; i < 4; i++) grid.push(userRisks.slice(i * 4, i * 4 + 4));

            for (let i = 0; i < 4; i++) {
                if (grid[i].every(v => v)) lines++;
                if ([grid[0][i], grid[1][i], grid[2][i], grid[3][i]].every(v => v)) lines++;
            }
            if ([grid[0][0], grid[1][1], grid[2][2], grid[3][3]].every(v => v)) lines++;
            if ([grid[0][3], grid[1][2], grid[2][1], grid[3][0]].every(v => v)) lines++;

            document.getElementById('risk-score').innerText = riskCount;
            document.getElementById('line-score').innerText = lines;

            // ç¶œåˆè©•ä¼°å»ºè­°èˆ‡å‹•æ…‹èƒŒæ™¯
            const adviceContainer = document.getElementById('advice-container');
            let scoreAdvice = "";
            
            // ç§»é™¤èˆŠçš„é¡åˆ¥
            adviceContainer.classList.remove('risk-bg-low', 'risk-bg-mid', 'risk-bg-high');

            if (riskCount <= 4) {
                adviceContainer.classList.add('risk-bg-low');
                scoreAdvice = "ä½ çš„ç”Ÿæ´»ç‹€æ…‹ç›¸ç•¶ç©©å›ºï¼å°±åƒæ“æœ‰é«˜ç­‰ç´šæŠ—æ€§è£å‚™ï¼Œå¤§å¤šæ•¸ç¿’æ…£éƒ½æœ‰åŠ©æ–¼å¤§è…¦ä¿æŒæ¸…æ™°èˆ‡å¹³è¡¡ï¼Œè«‹ç¹¼çºŒä¿æŒé€™ç¨®è‰¯å¥½çš„ç¯€å¥ï¼";
            } else if (riskCount <= 8) {
                adviceContainer.classList.add('risk-bg-mid');
                scoreAdvice = "å˜ï¼åµæ¸¬åˆ°ä½ çš„è­·ç›¾å‡ºç¾è£‚ç—•ã€‚é›–ç„¶ç›®å‰é‚„èƒ½æ‡‰ä»˜ï¼Œä½†é•·æœŸç´¯ç©çš„å¾®å°æå‚·å¯èƒ½æœƒè®“å¤§è…¦è¼ƒé›£æŠµç¦¦å£“åŠ›æ”»æ“Šï¼Œå»ºè­°æŒ‘é¸ 1-2 å€‹æœ€å®¹æ˜“ä¿®å¾©çš„é …ç›®é–‹å§‹èª¿æ•´ï¼";
            } else {
                adviceContainer.classList.add('risk-bg-high');
                scoreAdvice = "è­¦å ±è­¦å ±ï¼ä½ çš„ç‹€æ…‹è™•æ–¼ã€Œé«˜è€—èƒ½ã€å±éšªå€ï¼ä½ çš„è¨±å¤šç¿’æ…£æ­£åœ¨æŒçºŒé™ä½ä½ çš„å¿ƒéˆé˜²ç¦¦åŠ›ï¼Œè«‹å‹™å¿…èª¿æ•´ç”Ÿæ´»ç¿’æ…£ï¼Œä¸¦å°‹æ‰¾å®‰å…¨çš„ç‡Ÿç«ä¼‘æ¯èˆ‡æ¢å¾©ï¼";
            }
            document.getElementById('score-advice').innerText = scoreAdvice;

            let bingoAdvice = "";
            if (lines === 0) {
                bingoAdvice = "ç›®å‰æ²’æœ‰å½¢æˆé€£ç·šè©›å’’ï¼Œä»£è¡¨ä½ çš„é¢¨éšªæ¯”è¼ƒåˆ†æ•£ï¼Œå°šæœªå½¢æˆç‰¢ä¸å¯ç ´çš„è² é¢å¾ªç’°ç¶²ï¼Œé€™æ˜¯å¥½ç¾è±¡ï¼";
            } else {
                bingoAdvice = "é€£ç·šçš„å‡ºç¾ä»£è¡¨é¢¨éšªç¿’æ…£å·²ç¶“å½¢æˆé€£é–æ•ˆæ‡‰ã€‚é€™äº›ç¿’æ…£å¾€å¾€æœƒäº’ç›¸å¼·åŒ–ï¼ˆä¾‹å¦‚ï¼šç†¬å¤œå°è‡´ä¸åƒæ—©é¤ï¼‰ï¼Œå»ºè­°ä½ å„ªå…ˆå˜—è©¦æ–¬æ–·å…¶ä¸­ä¸€æ¢é€£ç·šï¼";
            }
            document.getElementById('bingo-advice').innerText = bingoAdvice;
        }

        function openModal(idx) {
            const data = bingoLayout[idx];
            document.getElementById('modal-title').innerText = data.tag;
            document.getElementById('modal-impact').innerText = data.impact;
            document.getElementById('modal-evidence').innerText = data.evidence;
            document.getElementById('detail-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('detail-modal').style.display = 'none';
        }
    </script>
</body>
</html>
